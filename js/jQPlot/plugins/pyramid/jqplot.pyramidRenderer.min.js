(function($){if($.jqplot.PyramidAxisRenderer===undefined){$.ajax({url:$.jqplot.pluginLocation+"jqplot.pyramidAxisRenderer.js",dataType:"script",async:false})
}if($.jqplot.PyramidGridRenderer===undefined){$.ajax({url:$.jqplot.pluginLocation+"jqplot.pyramidGridRenderer.js",dataType:"script",async:false})
}$.jqplot.PyramidRenderer=function(){$.jqplot.LineRenderer.call(this)};$.jqplot.PyramidRenderer.prototype=new $.jqplot.LineRenderer();
$.jqplot.PyramidRenderer.prototype.constructor=$.jqplot.PyramidRenderer;$.jqplot.PyramidRenderer.prototype.init=function(options,plot){options=options||{};
this._type="pyramid";this.barPadding=10;this.barWidth=null;this.fill=true;this.highlightMouseOver=true;
this.highlightMouseDown=false;this.highlightColors=[];this.highlightThreshold=2;this.synchronizeHighlight=false;
this.offsetBars=false;if(options.highlightMouseDown&&options.highlightMouseOver==null){options.highlightMouseOver=false
}this.side="right";$.extend(true,this,options);if(this.side==="left"){this._highlightThreshold=[[-this.highlightThreshold,0],[-this.highlightThreshold,0],[0,0],[0,0]]
}else{this._highlightThreshold=[[0,0],[0,0],[this.highlightThreshold,0],[this.highlightThreshold,0]]
}this.renderer.options=options;this._highlightedPoint=null;this._dataColors=[];this._barPoints=[];
this.fillAxis="y";this._primaryAxis="_yaxis";this._xnudge=0;var opts={lineJoin:"miter",lineCap:"butt",fill:this.fill,fillRect:this.fill,isarc:false,strokeStyle:this.color,fillStyle:this.color,closePath:this.fill,lineWidth:this.lineWidth};
this.renderer.shapeRenderer.init(opts);var shadow_offset=options.shadowOffset;if(shadow_offset==null){if(this.lineWidth>2.5){shadow_offset=1.25*(1+(Math.atan((this.lineWidth/2.5))/0.785398163-1)*0.6)
}else{shadow_offset=1.25*Math.atan((this.lineWidth/2.5))/0.785398163}}var sopts={lineJoin:"miter",lineCap:"butt",fill:this.fill,fillRect:this.fill,isarc:false,angle:this.shadowAngle,offset:shadow_offset,alpha:this.shadowAlpha,depth:this.shadowDepth,closePath:this.fill,lineWidth:this.lineWidth};
this.renderer.shadowRenderer.init(sopts);plot.postDrawHooks.addOnce(postPlotDraw);
plot.eventListenerHooks.addOnce("jqplotMouseMove",handleMove);if(this.side==="left"){for(var i=0,l=this.data.length;
i<l;i++){this.data[i][1]=-Math.abs(this.data[i][1])}}};$.jqplot.PyramidRenderer.prototype.setGridData=function(plot){var xp=this._xaxis.series_u2p;
var yp=this._yaxis.series_u2p;var data=this._plotData;var pdata=this._prevPlotData;
this.gridData=[];this._prevGridData=[];var l=data.length;var adjust=false;var i;for(i=0;
i<l;i++){if(data[i][1]<0){this.side="left"}}if(this._yaxis.name==="yMidAxis"&&this.side==="right"){this._xnudge=this._xaxis.max/2000;
adjust=true}for(i=0;i<l;i++){if(data[i][0]!=null&&data[i][1]!=null){this.gridData.push([xp(data[i][1]),yp(data[i][0])])
}else{if(data[i][0]==null){this.gridData.push([xp(data[i][1]),null])}else{if(data[i][1]==null){this.gridData.push(null,[yp(data[i][0])])
}}}if(data[i][1]===0&&adjust){this.gridData[i][0]=xp(this._xnudge)}}};$.jqplot.PyramidRenderer.prototype.makeGridData=function(data,plot){var xp=this._xaxis.series_u2p;
var yp=this._yaxis.series_u2p;var gd=[];var l=data.length;var adjust=false;var i;
for(i=0;i<l;i++){if(data[i][1]<0){this.side="left"}}if(this._yaxis.name==="yMidAxis"&&this.side==="right"){this._xnudge=this._xaxis.max/2000;
adjust=true}for(i=0;i<l;i++){if(data[i][0]!=null&&data[i][1]!=null){gd.push([xp(data[i][1]),yp(data[i][0])])
}else{if(data[i][0]==null){gd.push([xp(data[i][1]),null])}else{if(data[i][1]==null){gd.push([null,yp(data[i][0])])
}}}if(data[i][1]===0&&adjust){gd[i][0]=xp(this._xnudge)}}return gd};$.jqplot.PyramidRenderer.prototype.setBarWidth=function(){var i;
var nvals=0;var nseries=0;var paxis=this[this._primaryAxis];var s,series,pos;nvals=paxis.max-paxis.min;
var nticks=paxis.numberTicks;var nbins=(nticks-1)/2;var temp=(this.barPadding===0)?1:0;
if(paxis.name=="xaxis"||paxis.name=="x2axis"){this.barWidth=(paxis._offsets.max-paxis._offsets.min)/nvals-this.barPadding+temp
}else{if(this.fill){this.barWidth=(paxis._offsets.min-paxis._offsets.max)/nvals-this.barPadding+temp
}else{this.barWidth=(paxis._offsets.min-paxis._offsets.max)/nvals}}};$.jqplot.PyramidRenderer.prototype.draw=function(ctx,gridData,options){var i;
var opts=$.extend({},options);var shadow=(opts.shadow!=undefined)?opts.shadow:this.shadow;
var showLine=(opts.showLine!=undefined)?opts.showLine:this.showLine;var fill=(opts.fill!=undefined)?opts.fill:this.fill;
var xp=this._xaxis.series_u2p;var yp=this._yaxis.series_u2p;var pointx,pointy;this._dataColors=[];
this._barPoints=[];if(this.renderer.options.barWidth==null){this.renderer.setBarWidth.call(this)
}var points=[],w,h;if(showLine){var negativeColors=new $.jqplot.ColorGenerator(this.negativeSeriesColors);
var positiveColors=new $.jqplot.ColorGenerator(this.seriesColors);var negativeColor=negativeColors.get(this.index);
if(!this.useNegativeColors){negativeColor=opts.fillStyle}var positiveColor=opts.fillStyle;
var base;var xstart=this._xaxis.series_u2p(this._xnudge);var ystart=this._yaxis.series_u2p(this._yaxis.min);
var yend=this._yaxis.series_u2p(this._yaxis.max);var bw=this.barWidth;var bw2=bw/2;
var points=[];var yadj=this.offsetBars?bw2:0;for(var i=0,l=gridData.length;i<l;i++){if(this.data[i][0]==null){continue
}base=gridData[i][1];if(this._plotData[i][1]<0){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){opts.fillStyle=negativeColors.next()
}else{opts.fillStyle=positiveColors.next()}}}else{if(this.varyBarColor&&!this._stack){opts.fillStyle=positiveColors.next()
}else{opts.fillStyle=positiveColor}}if(this.fill){if(this._plotData[i][1]>=0){w=gridData[i][0]-xstart;
h=this.barWidth;points=[xstart,base-bw2-yadj,w,h]}else{w=xstart-gridData[i][0];h=this.barWidth;
points=[gridData[i][0],base-bw2-yadj,w,h]}this._barPoints.push([[points[0],points[1]+h],[points[0],points[1]],[points[0]+w,points[1]],[points[0]+w,points[1]+h]]);
if(shadow){this.renderer.shadowRenderer.draw(ctx,points)}var clr=opts.fillStyle||this.color;
this._dataColors.push(clr);this.renderer.shapeRenderer.draw(ctx,points,opts)}else{if(i===0){points=[[xstart,ystart],[gridData[i][0],ystart],[gridData[i][0],gridData[i][1]-bw2-yadj]]
}else{if(i<l-1){points=points.concat([[gridData[i-1][0],gridData[i-1][1]-bw2-yadj],[gridData[i][0],gridData[i][1]+bw2-yadj],[gridData[i][0],gridData[i][1]-bw2-yadj]])
}else{points=points.concat([[gridData[i-1][0],gridData[i-1][1]-bw2-yadj],[gridData[i][0],gridData[i][1]+bw2-yadj],[gridData[i][0],yend],[xstart,yend]]);
if(shadow){this.renderer.shadowRenderer.draw(ctx,points)}var clr=opts.fillStyle||this.color;
this._dataColors.push(clr);this.renderer.shapeRenderer.draw(ctx,points,opts)}}}}}if(this.highlightColors.length==0){this.highlightColors=$.jqplot.computeHighlightColors(this._dataColors)
}else{if(typeof(this.highlightColors)=="string"){this.highlightColors=[];for(var i=0;
i<this._dataColors.length;i++){this.highlightColors.push(this.highlightColors)}}}};
function preInit(target,data,options){options=options||{};options.axesDefaults=options.axesDefaults||{};
options.grid=options.grid||{};options.legend=options.legend||{};options.seriesDefaults=options.seriesDefaults||{};
var setopts=false;if(options.seriesDefaults.renderer===$.jqplot.PyramidRenderer){setopts=true
}else{if(options.series){for(var i=0;i<options.series.length;i++){if(options.series[i].renderer===$.jqplot.PyramidRenderer){setopts=true
}}}}if(setopts){options.axesDefaults.renderer=$.jqplot.PyramidAxisRenderer;options.grid.renderer=$.jqplot.PyramidGridRenderer;
options.seriesDefaults.pointLabels={show:false}}}function postPlotDraw(){if(this.plugins.pyramidRenderer&&this.plugins.pyramidRenderer.highlightCanvas){this.plugins.pyramidRenderer.highlightCanvas.resetCanvas();
this.plugins.pyramidRenderer.highlightCanvas=null}this.plugins.pyramidRenderer={highlightedSeriesIndex:null};
this.plugins.pyramidRenderer.highlightCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.pyramidRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pyramidRenderer-highlight-canvas",this._plotDimensions,this));
this.plugins.pyramidRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(ev){unhighlight(ev.data.plot)
})}function highlight(plot,sidx,pidx,points){var s=plot.series[sidx];var canvas=plot.plugins.pyramidRenderer.highlightCanvas;
canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);s._highlightedPoint=pidx;
plot.plugins.pyramidRenderer.highlightedSeriesIndex=sidx;var opts={fillStyle:s.highlightColors[pidx],fillRect:false};
s.renderer.shapeRenderer.draw(canvas._ctx,points,opts);if(s.synchronizeHighlight!==false&&plot.series.length>=s.synchronizeHighlight&&s.synchronizeHighlight!==sidx){s=plot.series[s.synchronizeHighlight];
opts={fillStyle:s.highlightColors[pidx],fillRect:false};s.renderer.shapeRenderer.draw(canvas._ctx,s._barPoints[pidx],opts)
}canvas=null}function unhighlight(plot){var canvas=plot.plugins.pyramidRenderer.highlightCanvas;
canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);for(var i=0;
i<plot.series.length;i++){plot.series[i]._highlightedPoint=null}plot.plugins.pyramidRenderer.highlightedSeriesIndex=null;
plot.target.trigger("jqplotDataUnhighlight");canvas=null}function handleMove(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];
var evt1=jQuery.Event("jqplotDataMouseOver");evt1.pageX=ev.pageX;evt1.pageY=ev.pageY;
plot.target.trigger(evt1,ins);if(plot.series[ins[0]].highlightMouseOver&&!(ins[0]==plot.plugins.pyramidRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){var evt=jQuery.Event("jqplotDataHighlight");
evt.which=ev.which;evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);
highlight(plot,neighbor.seriesIndex,neighbor.pointIndex,neighbor.points)}}else{if(neighbor==null){unhighlight(plot)
}}}$.jqplot.preInitHooks.push(preInit)})(jQuery);