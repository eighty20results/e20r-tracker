(function($){$.jqplot.MekkoAxisRenderer=function(){};$.jqplot.MekkoAxisRenderer.prototype.init=function(options){this.tickMode;
this.barLabelRenderer=$.jqplot.AxisLabelRenderer;this.barLabels=this.barLabels||[];
this.barLabelOptions={};this.tickOptions=$.extend(true,{showGridline:false},this.tickOptions);
this._barLabels=[];$.extend(true,this,options);if(this.name=="yaxis"){this.tickOptions.formatString=this.tickOptions.formatString||"%d%"
}var db=this._dataBounds;db.min=0;if(this.name=="yaxis"||this.name=="y2axis"){db.max=100;
this.tickMode="even"}else{if(this.name=="xaxis"){this.tickMode=(this.tickMode==null)?"bar":this.tickMode;
for(var i=0;i<this._series.length;i++){db.max+=this._series[i]._sumy}}else{if(this.name=="x2axis"){this.tickMode=(this.tickMode==null)?"even":this.tickMode;
for(var i=0;i<this._series.length;i++){db.max+=this._series[i]._sumy}}}}};$.jqplot.MekkoAxisRenderer.prototype.draw=function(ctx,plot){if(this.show){this.renderer.createTicks.call(this);
var dim=0;var temp;var elem=document.createElement("div");this._elem=$(elem);this._elem.addClass("jqplot-axis jqplot-"+this.name);
this._elem.css("position","absolute");elem=null;if(this.name=="xaxis"||this.name=="x2axis"){this._elem.width(this._plotDimensions.width)
}else{this._elem.height(this._plotDimensions.height)}this.labelOptions.axis=this.name;
this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){this._elem.append(this._label.draw(ctx))
}var t,tick,elem;if(this.showTicks){t=this._ticks;for(var i=0;i<t.length;i++){tick=t[i];
if(tick.showLabel&&(!tick.isMinorTick||this.showMinorTicks)){this._elem.append(tick.draw(ctx))
}}}for(i=0;i<this.barLabels.length;i++){this.barLabelOptions.axis=this.name;this.barLabelOptions.label=this.barLabels[i];
this._barLabels.push(new this.barLabelRenderer(this.barLabelOptions));if(this.tickMode!="bar"){this._barLabels[i].show=false
}if(this._barLabels[i].show){var elem=this._barLabels[i].draw(ctx,plot);elem.removeClass("jqplot-"+this.name+"-label");
elem.addClass("jqplot-"+this.name+"-tick");elem.addClass("jqplot-mekko-barLabel");
elem.appendTo(this._elem);elem=null}}}return this._elem};$.jqplot.MekkoAxisRenderer.prototype.reset=function(){this.min=this._min;
this.max=this._max;this.tickInterval=this._tickInterval;this.numberTicks=this._numberTicks
};$.jqplot.MekkoAxisRenderer.prototype.set=function(){var dim=0;var temp;var w=0;
var h=0;var lshow=(this._label==null)?false:this._label.show;if(this.show&&this.showTicks){var t=this._ticks;
for(var i=0;i<t.length;i++){var tick=t[i];if(tick.showLabel&&(!tick.isMinorTick||this.showMinorTicks)){if(this.name=="xaxis"||this.name=="x2axis"){temp=tick._elem.outerHeight(true)
}else{temp=tick._elem.outerWidth(true)}if(temp>dim){dim=temp}}}if(lshow){w=this._label._elem.outerWidth(true);
h=this._label._elem.outerHeight(true)}if(this.name=="xaxis"){dim=dim+h;this._elem.css({height:dim+"px",left:"0px",bottom:"0px"})
}else{if(this.name=="x2axis"){dim=dim+h;this._elem.css({height:dim+"px",left:"0px",top:"0px"})
}else{if(this.name=="yaxis"){dim=dim+w;this._elem.css({width:dim+"px",left:"0px",top:"0px"});
if(lshow&&this._label.constructor==$.jqplot.AxisLabelRenderer){this._label._elem.css("width",w+"px")
}}else{dim=dim+w;this._elem.css({width:dim+"px",right:"0px",top:"0px"});if(lshow&&this._label.constructor==$.jqplot.AxisLabelRenderer){this._label._elem.css("width",w+"px")
}}}}}};$.jqplot.MekkoAxisRenderer.prototype.createTicks=function(){var ticks=this._ticks;
var userTicks=this.ticks;var name=this.name;var db=this._dataBounds;var dim,interval;
var min,max;var pos1,pos2;var t,tt,i,j;if(userTicks.length){for(i=0;i<userTicks.length;
i++){var ut=userTicks[i];var t=new this.tickRenderer(this.tickOptions);if(ut.constructor==Array){t.value=ut[0];
t.label=ut[1];if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false
}}t.setTick(ut[0],this.name);this._ticks.push(t)}else{t.value=ut;if(!this.showTicks){t.showLabel=false;
t.showMark=false}else{if(!this.showTickMarks){t.showMark=false}}t.setTick(ut,this.name);
this._ticks.push(t)}}this.numberTicks=userTicks.length;this.min=this._ticks[0].value;
this.max=this._ticks[this.numberTicks-1].value;this.tickInterval=(this.max-this.min)/(this.numberTicks-1)
}else{if(name=="xaxis"||name=="x2axis"){dim=this._plotDimensions.width}else{dim=this._plotDimensions.height
}if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null
}min=(this.min!=null)?this.min:db.min;max=(this.max!=null)?this.max:db.max;if(min==max){var adj=0.05;
if(min>0){adj=Math.max(Math.log(min)/Math.LN10,0.05)}min-=adj;max+=adj}var range=max-min;
var rmin,rmax;var temp,prev,curr;var ynumticks=[3,5,6,11,21];if(this.name=="yaxis"||this.name=="y2axis"){this.min=0;
this.max=100;if(!this.numberTicks){if(this.tickInterval){this.numberTicks=3+Math.ceil(range/this.tickInterval)
}else{temp=2+Math.ceil((dim-(this.tickSpacing-1))/this.tickSpacing);for(i=0;i<ynumticks.length;
i++){curr=temp/ynumticks[i];if(curr==1){this.numberTicks=ynumticks[i];break}else{if(curr>1){prev=curr;
continue}else{if(curr<1){if(Math.abs(prev-1)<Math.abs(curr-1)){this.numberTicks=ynumticks[i-1];
break}else{this.numberTicks=ynumticks[i];break}}else{if(i==ynumticks.length-1){this.numberTicks=ynumticks[i]
}}}}}this.tickInterval=range/(this.numberTicks-1)}}else{this.tickInterval=range/(this.numberTicks-1)
}for(var i=0;i<this.numberTicks;i++){tt=this.min+i*this.tickInterval;t=new this.tickRenderer(this.tickOptions);
if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false
}}t.setTick(tt,this.name);this._ticks.push(t)}}else{if(this.tickMode=="bar"){this.min=0;
this.numberTicks=this._series.length+1;t=new this.tickRenderer(this.tickOptions);
if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false
}}t.setTick(0,this.name);this._ticks.push(t);temp=0;for(i=1;i<this.numberTicks;i++){temp+=this._series[i-1]._sumy;
t=new this.tickRenderer(this.tickOptions);if(!this.showTicks){t.showLabel=false;t.showMark=false
}else{if(!this.showTickMarks){t.showMark=false}}t.setTick(temp,this.name);this._ticks.push(t)
}this.max=this.max||temp;if(this.max>temp){t=new this.tickRenderer(this.tickOptions);
if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false
}}t.setTick(this.max,this.name);this._ticks.push(t)}}else{if(this.tickMode=="even"){this.min=0;
this.max=this.max||db.max;var nt=2+Math.ceil((dim-(this.tickSpacing-1))/this.tickSpacing);
range=this.max-this.min;this.numberTicks=nt;this.tickInterval=range/(this.numberTicks-1);
for(i=0;i<this.numberTicks;i++){tt=this.min+i*this.tickInterval;t=new this.tickRenderer(this.tickOptions);
if(!this.showTicks){t.showLabel=false;t.showMark=false}else{if(!this.showTickMarks){t.showMark=false
}}t.setTick(tt,this.name);this._ticks.push(t)}}}}}};$.jqplot.MekkoAxisRenderer.prototype.pack=function(pos,offsets){var ticks=this._ticks;
var max=this.max;var min=this.min;var offmax=offsets.max;var offmin=offsets.min;var lshow=(this._label==null)?false:this._label.show;
for(var p in pos){this._elem.css(p,pos[p])}this._offsets=offsets;var pixellength=offmax-offmin;
var unitlength=max-min;this.p2u=function(p){return(p-offmin)*unitlength/pixellength+min
};this.u2p=function(u){return(u-min)*pixellength/unitlength+offmin};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(u){return(u-min)*pixellength/unitlength
};this.series_p2u=function(p){return p*unitlength/pixellength+min}}else{this.series_u2p=function(u){return(u-max)*pixellength/unitlength
};this.series_p2u=function(p){return p*unitlength/pixellength+max}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(var i=0;
i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){var temp=(this.name=="xaxis")?1:-1;
switch(t.labelPosition){case"auto":if(temp*t.angle<0){shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2
}else{shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2}break;case"end":shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;
break;case"start":shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2;
break;case"middle":shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;
break;default:shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;
break}}else{shim=-t.getWidth()/2}var val=this.u2p(t.value)+shim+"px";t._elem.css("left",val);
t.pack()}}var w;if(lshow){w=this._label._elem.outerWidth(true);this._label._elem.css("left",offmin+pixellength/2-w/2+"px");
if(this.name=="xaxis"){this._label._elem.css("bottom","0px")}else{this._label._elem.css("top","0px")
}this._label.pack()}var b,l,r;for(var i=0;i<this.barLabels.length;i++){b=this._barLabels[i];
if(b.show){w=b.getWidth();l=this._ticks[i].getLeft()+this._ticks[i].getWidth();r=this._ticks[i+1].getLeft();
b._elem.css("left",(r+l-w)/2+"px");b._elem.css("top",this._ticks[i]._elem.css("top"));
b.pack()}}}else{for(var i=0;i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;
if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){var temp=(this.name=="yaxis")?1:-1;
switch(t.labelPosition){case"auto":case"end":if(temp*t.angle<0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2
}else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2
}break;case"start":if(t.angle>0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2
}else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2
}break;case"middle":shim=-t.getHeight()/2;break;default:shim=-t.getHeight()/2;break
}}else{shim=-t.getHeight()/2}var val=this.u2p(t.value)+shim+"px";t._elem.css("top",val);
t.pack()}}if(lshow){var h=this._label._elem.outerHeight(true);this._label._elem.css("top",offmax-pixellength/2-h/2+"px");
if(this.name=="yaxis"){this._label._elem.css("left","0px")}else{this._label._elem.css("right","0px")
}this._label.pack()}}}}})(jQuery);